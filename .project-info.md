# Government AI Prototype - Persistent Instruction Layering Demo

This directory contains all the implementation files for the Government AI Prototype. Below is a quick reference for what each file does:

## Quick Start Commands

```bash
# Build and start all services
docker-compose up -d

# Check service status
docker-compose ps

# View logs
docker-compose logs -f

# Stop all services
docker-compose down

# Test the API
curl -X POST http://localhost:3000/api/chat/unemployment-benefits \
  -H "Content-Type: application/json" \
  -d '{"message": "How do I apply for unemployment benefits?"}'

# Run tests
./test.sh
```

## File Structure

### Root Directory
- `docker-compose.yml` - Multi-container orchestration
- `README.md` - Complete documentation and usage guide
- `INSTRUCTIONS.md` - Original project specifications
- `TESTING.md` - Comprehensive testing documentation
- `GITHUB-ACTIONS.md` - CI/CD pipeline documentation
- `test.sh` - Executable test runner script
- `.gitignore` - Version control exclusions

### GitHub Actions (`/.github/workflows`)
- `ci.yml` - Automated CI/CD pipeline for tests and security scans
- `TESTING.md` - Comprehensive testing documentation
- `test.sh` - Test runner script for all test categories
- `.gitignore` - Git exclusion patterns

### API Service (`/api`)
- `Dockerfile` - Container configuration for Node.js API
- `package.json` - Node.js dependencies and scripts (includes test dependencies)
- `server.js` - Express.js application with instruction layering logic

### Configuration (`/api/config`)
- `unemployment-benefits.yaml` - Unemployment benefits assistant persona
- `parks-recreation.yaml` - Parks and recreation guide persona  
- `business-licensing.yaml` - Business licensing assistant persona
- `default.yaml` - General purpose assistant persona

### Test Suite (`/api/__tests__`)
- `setup.js` - Global test configuration and helpers
- `config.test.js` - Unit tests for configuration loading
- `api.test.js` - Integration tests for API endpoints
- `performance.test.js` - Performance and load testing
- `e2e.test.js` - End-to-end workflow testing

## API Endpoints

| Method | Endpoint | Purpose |
|--------|----------|---------|
| GET | `/health` | Service health check |
| GET | `/api` | API information and available endpoints |
| POST | `/api/chat/unemployment-benefits` | Unemployment assistance |
| POST | `/api/chat/parks-recreation` | Parks and recreation info |
| POST | `/api/chat/business-licensing` | Business licensing guidance |
| POST | `/api/chat/default` | General purpose assistant |

## Testing Overview

The project includes a comprehensive test suite:

### Test Categories
- **Unit Tests**: Configuration loading, data validation
- **Integration Tests**: API endpoints, request/response handling  
- **Performance Tests**: Response times, concurrent requests
- **End-to-End Tests**: Complete workflows, system integration

### Running Tests
```bash
# Run all tests
./test.sh

# Run specific categories
./test.sh unit         # Unit tests only
./test.sh integration  # API integration tests
./test.sh performance  # Performance benchmarks
./test.sh e2e         # End-to-end workflows
./test.sh coverage    # Full coverage report
```

### Testing Features
- ✅ Mocked AI responses for fast, reliable testing
- ✅ Realistic government service scenarios
- ✅ Performance monitoring and benchmarking
- ✅ Cross-persona consistency validation
- ✅ Error handling and resilience testing
- ✅ Coverage reporting with HTML output

### CI/CD Pipeline
- ✅ Automated testing on every commit to main branch
- ✅ Unit and integration test execution
- ✅ npm audit security scanning for dependencies
- ✅ Test coverage report generation
- ✅ Pull request dependency review
- ✅ GitHub Actions status badges and summaries

## Architecture Overview

```
Client Request → API Service → Persona Config → Instruction Layering → Ollama/Phi-3 → Response
```

The system demonstrates how the same language model can provide specialized government service experiences through strategic prompt engineering and configuration management.

## Development Notes

- The API automatically loads and caches YAML configurations
- All personas use the same underlying Phi-3 model via Ollama
- Docker Compose handles service dependencies and networking
- Health checks ensure services are ready before accepting traffic
- Comprehensive error handling and logging throughout

This prototype showcases persistent instruction layering - a powerful technique for creating specialized AI assistants without training separate models.
